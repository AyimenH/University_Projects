---
title: "lab6"
author: "Ayimen H."
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(readxl)
df <- read_excel("Snowgeese.xls", col_names = FALSE)
colnames(df) <- c("trial", "diet", "weightChange", "digestionEff", "acidDeterFiber")

df$diet <- as.factor(df$diet)
df$weightChange <- as.numeric(df$weightChange)

plants_diet <- df[df$diet == "Plants", ]
chow_diet <- df[df$diet == "Chow", ]
```
1. Weight change

(a) Calculate the mean and standard deviation for weight change for geese fed a 
plant diet. Then, calculate the mean and standard deviation for geese fed a chow diet.
```{r}
plants_mean <- mean(plants_diet$weightChange, na.rm = TRUE)
plants_sd <- sd(plants_diet$weightChange, na.rm = TRUE)
plants_n <- nrow(plants_diet)

chow_mean <- mean(chow_diet$weightChange, na.rm = TRUE)
chow_sd <- sd(chow_diet$weightChange, na.rm = TRUE)
chow_n <- nrow(chow_diet)

plants_mean
plants_sd

chow_mean
chow_sd
```
(b) Calculate the 99% large-sample confidence interval for μ for the plant diet group.
Also calculate the 99% large-sample confidence interval for the chow diet group.
```{r}
z_score <- qnorm(0.995)

plants_error_margin <- z_score * (plants_sd / sqrt(plants_n))
plants_ci_lower <- plants_mean - plants_error_margin
plants_ci_upper <- plants_mean + plants_error_margin
plants_ci <- c(plants_ci_lower, plants_ci_upper)

chow_error_margin <- z_score * (chow_sd / sqrt(chow_n))
chow_ci_lower <- chow_mean - chow_error_margin
chow_ci_upper <- chow_mean + chow_error_margin
chow_ci <- c(chow_ci_lower, chow_ci_upper)

plants_ci
chow_ci
```
(c) Based on these results (disregarding the sample size caveat for now), is 
there evidence that geese fed a plant diet will, on average, either gain or lose 
weight? What about for geese fed a chow diet?

  For the Plants diet I believe there is no evidence that geese fed a plants diet 
  will, on average, either gain or lose weight based on the results for b. However
  there is evidence that geese fed a chow diet will on average gain weight.
  
(d) Using your results from part (a), calculate a 99% confidence interval for the 
mean weight change for geese fed a plant diet (using the Student’s t distribution), 
and a 99% confidence interval for the mean weight change for geese fed a chow diet.
```{r}
plants_df <- plants_n - 1
chow_df <- chow_n - 1

t_critical_plants <- qt(0.995, plants_df)
t_critical_chow <- qt(0.995, chow_df)

plants_t_margin <- t_critical_plants * (plants_sd / sqrt(plants_n))
plants_t_ci_lower <- plants_mean - plants_t_margin
plants_t_ci_upper <- plants_mean + plants_t_margin
plants_t_ci <- c(plants_t_ci_lower, plants_t_ci_upper)

chow_t_margin <- t_critical_chow * (chow_sd / sqrt(chow_n))
chow_t_ci_lower <- chow_mean - chow_t_margin
chow_t_ci_upper <- chow_mean + chow_t_margin
chow_t_ci <- c(chow_t_ci_lower, chow_t_ci_upper)

plants_t_ci
chow_t_ci
```
(e) Based on these results (and given the assumption that the underlying population 
is normally distributed), is there evidence that geese fed a plant diet will, on 
average, either gain or lose weight? What about for geese fed a chow diet?

Based on the results of d, there is no evidence geese fed a plants diet will, on 
average, either gain or lose weight. As for the Chow diet there is evidence that 
geese fed a chow diet will, on average, gain weight. 

2. Digestion efficiency

(a) Calculate the means and standard deviations for digestion efficiency for geese 
fed a plant diet, and for geese fed a chow diet.
```{r}
plants_digestion_mean <- mean(plants_diet$digestionEff, na.rm = TRUE)
plants_digestion_sd <- sd(plants_diet$digestionEff, na.rm = TRUE)
plants_n <- nrow(plants_diet)

chow_digestion_mean <- mean(chow_diet$digestionEff, na.rm = TRUE)
chow_digestion_sd <- sd(chow_diet$digestionEff, na.rm = TRUE)
chow_n <- nrow(chow_diet)

plants_digestion_mean
plants_digestion_sd

chow_digestion_mean
chow_digestion_sd
```
(b) Write code to implement this formula and calculate the confidence interval 
for this difference.
```{r}
x1 <- plants_digestion_mean
s1 <- plants_digestion_sd
n1 <- plants_n

x2 <- chow_digestion_mean
s2 <- chow_digestion_sd
n2 <- chow_n

mean_diff <- x1 - x2

df_numerator <- (s1^2/n1 + s2^2/n2)^2
df_denominator <- (1/(n1-1)) * (s1^2/n1)^2 + (1/(n2-1)) * (s2^2/n2)^2

df <- df_numerator / df_denominator

t_crit <- qt(0.995, df)

se <- sqrt(s1^2/n1 + s2^2/n2)
margin <- t_crit * se

ci_lower <- mean_diff - margin
ci_upper <- mean_diff + margin
ci <- c(ci_lower, ci_upper)

cat("Mean difference:", mean_diff, "\n")
cat("Degrees of freedom:", df, "\n")
cat("99% confidence interval:", ci_lower, "to", ci_upper, "\n")
```
(c) Based on your confidence interval, what can you say about how the average 
digestion efficiency compares between the two diets?

Based on the results of b, there is evidence that the chow diet results in a higher 
average digestion efficiency.
