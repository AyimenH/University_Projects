---
title: "Lab5"
author: "Your Name"
date: "`r Sys.Date()`"
output: html_document
---

Question (a): Calculate the mean x and the variance s2 of the wave height sample data.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
wave_data <- read.csv("cape_elizabeth_2023_data.csv")
```

```{r}
wave_data <- read.csv("cape_elizabeth_2023_data.csv")
wave_heights <- wave_data$significant_wave_height_meters

mean_wave_height <- mean(wave_heights, na.rm = TRUE)
variance_wave_height <- var(wave_heights, na.rm = TRUE)

cat("Mean wave height:", mean_wave_height, "meters\n")
cat("Variance of wave height:", variance_wave_height, "meters^2\n")
```

Question (b): Generate a probability plot using the qnorm function, with parameters 
mean as the x you found in part (a), and sd as the square root of the variance s2 
from part (a).

```{r}
qqplot(
  qnorm(ppoints(length(wave_heights)), mean = mean_wave_height, sd = 
          sqrt(variance_wave_height)), sort(wave_heights),main = 
    "Normal Distribution")
```

Question (c): Generate a probability plot using the qunif function, with parameters 
as described above, matching the desired mean and variance to the sample values 
you calculated in part (a).

```{r}
c <- mean_wave_height
r <- sqrt(3 * variance_wave_height)
a <- c - r
b <- c + r

qqplot(
  qunif(ppoints(length(wave_heights)), min = a, max = b), sort(wave_heights),
  main = "Uniform Distribution")
```

## Question (d): Generate a probability plot using the qexp function, with 
parameters as described above, matching the desired mean to the sample mean you 
calculated in part (a).

```{r}
lambda <- 1 / mean_wave_height

qqplot(
  qexp(ppoints(length(wave_heights)), rate = lambda),
  sort(wave_heights),
  main = "Exponential Distribution")
```

Question (e):Generate a probability plot using the qgamma function, with parameters 
as described above, matching the desired mean and variance to the sample values you 
calculated in part (a).

```{r}
alpha <- (mean_wave_height^2) / variance_wave_height
beta <- variance_wave_height / mean_wave_height

qqplot(
  qgamma(ppoints(length(wave_heights)), shape = alpha, scale = beta),
  sort(wave_heights),
  main = "Gamma Distribution")
```

Question (f): Generate a probability plot using the qlnorm function, with parameters 
as described above, matching the desired mean and variance to the sample values you 
calculated in part (a).

```{r}
meanlog <- log(mean_wave_height / sqrt(1 + (variance_wave_height / (mean_wave_height^2))))
sdlog <- sqrt(log(1 + (variance_wave_height / (mean_wave_height^2))))

qqplot(
  qlnorm(ppoints(length(wave_heights)), meanlog = meanlog, sdlog = sdlog),
  sort(wave_heights),
  main = "Lognormal Distribution")
```

Question (g): Based on your probability plots, answer the question: Which of these 
five distributions is the best fit for our sample data?

```{r}

cat("I think the gamma distribution is the straightest line, so I believe it is
    the best fit for our sample data set")
```


Question (h): Plot the pdf of the distribution you found as the best fit for 
the wave height sample data, and plot a histogram of the sample data next to it 
(either horizontally or vertically). Compare the shapes of the two plots. How do 
they compare to each other? You may adjust the width of the histogram intervals 
to aid in this comparison.

```{r}
par(mfrow = c(1, 2))

hist(rgamma(length(wave_heights), shape = alpha, scale = beta), 
     probability = TRUE, main = "Gamma Distribution", xlab = 
       "Wave Height (m)")

hist(wave_heights, probability = TRUE, main = "Wave Sample Heights", xlab = 
       "Wave Height (m)")

par(mfrow = c(1, 1))
```

Question (i): Returning to the specific scenario for this lab, using the distribution 
you determined in part (g), what is the probability that at a randomly selected point 
in time, the significant wave height h will be greater than or equal to 5 meters?

```{r}

prob_i <- pgamma(5, shape = alpha, scale = beta, lower.tail = FALSE)
cat("P(X >= 5):", prob_i, "\n")
```

Question (j): Using this same kind of idea, and using the distribution you determined 
in part (g), what is the height h for which 95% of significant wave height readings 
would be expected to fall below h? In other words, what is h such that P (X â‰¤ h) = 0.95?

```{r}
prob_h <- qgamma(0.95, shape = alpha, scale = beta)
cat("P(X =< h) = 0.95:", prob_h, "meters\n")
```
